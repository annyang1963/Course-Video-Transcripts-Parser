1
00:00:00,000 --> 00:00:05,370
Let's go back to our grocery store dataset to make this a little more concrete.

2
00:00:05,370 --> 00:00:10,410
I decided that I wanted to bring back the botanical name columns we deleted before.

3
00:00:10,410 --> 00:00:15,180
I'm going to show you first how to do this in the Query settings applied steps,

4
00:00:15,180 --> 00:00:17,610
and then the Advanced Editor.

5
00:00:17,610 --> 00:00:20,460
Then for good measure, I'm going to intentionally break it,

6
00:00:20,460 --> 00:00:22,980
and show you how you can noodle through how to fix it.

7
00:00:22,980 --> 00:00:25,020
First, another microscale.

8
00:00:25,020 --> 00:00:27,390
Sometimes I close out of Query Settings,

9
00:00:27,390 --> 00:00:30,105
because I want to see more of the columns to the right,

10
00:00:30,105 --> 00:00:33,420
and it can be really annoying if you're newer to this,

11
00:00:33,420 --> 00:00:36,660
and you can't find the Query Settings to get it back.

12
00:00:36,660 --> 00:00:38,430
Let me just show you briefly,

13
00:00:38,430 --> 00:00:40,080
it's here under View,

14
00:00:40,080 --> 00:00:44,555
and this gear right here is your homing begin to bring it back.

15
00:00:44,555 --> 00:00:46,130
Here on the last step,

16
00:00:46,130 --> 00:00:49,395
we have removed some other columns,

17
00:00:49,395 --> 00:00:52,380
and we can see with this widget to the right,

18
00:00:52,380 --> 00:00:54,405
that we can make an adjustment.

19
00:00:54,405 --> 00:00:56,535
Let's go ahead and open that up.

20
00:00:56,535 --> 00:01:02,440
Here, we've removed other columns is giving you a shortlist of the columns to keep.

21
00:01:02,440 --> 00:01:05,145
We're just going to click Botanical name,

22
00:01:05,145 --> 00:01:07,860
and there it is, right back.

23
00:01:07,860 --> 00:01:15,000
But, let's make it a little bit more difficult on ourselves, and click.

24
00:01:15,160 --> 00:01:17,705
A second option you could take,

25
00:01:17,705 --> 00:01:22,645
is up here we have just one line of the M code right here,

26
00:01:22,645 --> 00:01:25,175
so we had Removed Other Columns,

27
00:01:25,175 --> 00:01:28,270
and here it's referencing that prior step here,

28
00:01:28,270 --> 00:01:29,455
see for Change Type.

29
00:01:29,455 --> 00:01:33,790
Change Type, and it saying Table select to keep.

30
00:01:33,790 --> 00:01:35,805
We have the PLU, Category,

31
00:01:35,805 --> 00:01:37,905
Commodity, Variety, and Size.

32
00:01:37,905 --> 00:01:47,370
I'm just going to manually type in in all caps, BOTANICAL NAME.

33
00:01:47,370 --> 00:01:55,705
I'm just going to hit this little guy right here for the checkmark, and there it is.

34
00:01:55,705 --> 00:01:58,490
Let's try one more.

35
00:01:58,490 --> 00:02:02,780
Home is where the Advanced Editor lives right here.

36
00:02:02,780 --> 00:02:05,325
Click on the Advanced Editor,

37
00:02:05,325 --> 00:02:10,770
and this gives us all of our individual steps one-by-one.

38
00:02:10,770 --> 00:02:14,510
Again, remember these are going to have the same names over here,

39
00:02:14,510 --> 00:02:15,890
as they do here,

40
00:02:15,890 --> 00:02:17,630
with the exception of navigation,

41
00:02:17,630 --> 00:02:21,120
which is always something funky like Produce Sheet.

42
00:02:21,290 --> 00:02:25,805
All I'm going to do here is just add to the last step,

43
00:02:25,805 --> 00:02:31,200
just like I did before, BOTANICAL NAME.

44
00:02:33,110 --> 00:02:36,315
Done. It pops up here automatically,

45
00:02:36,315 --> 00:02:37,590
it's already applied here,

46
00:02:37,590 --> 00:02:39,260
so if we clicked on this,

47
00:02:39,260 --> 00:02:42,550
you can see it already applied to that user interface,

48
00:02:42,550 --> 00:02:43,750
and the applied steps,

49
00:02:43,750 --> 00:02:45,400
or the Query Settings pane,

50
00:02:45,400 --> 00:02:47,255
and it's back for us.

51
00:02:47,255 --> 00:02:53,170
What if we decided we wanted to constrain the produce to just list apples.

52
00:02:53,170 --> 00:02:55,610
We wanted to do so earlier on in

53
00:02:55,610 --> 00:02:59,555
our applied steps to cut down on the number of rows earlier.

54
00:02:59,555 --> 00:03:04,130
Well, we can do that at the logical end of the applied steps so far,

55
00:03:04,130 --> 00:03:07,800
and we can move it up to be beneath promoted headers.

56
00:03:07,800 --> 00:03:10,880
But any step above this would generate an error,

57
00:03:10,880 --> 00:03:16,850
because the column name commodity wouldn't exist before the columns were promoted.

58
00:03:16,850 --> 00:03:20,040
Let me show you what I mean.

59
00:03:20,080 --> 00:03:24,630
I'm going to start by filtering for apples.

60
00:03:25,240 --> 00:03:27,730
That will add a step,

61
00:03:27,730 --> 00:03:30,150
here's my Filtered Row step.

62
00:03:30,150 --> 00:03:33,495
I can move that to under Promoted Headers,

63
00:03:33,495 --> 00:03:35,535
and it causes no problems whatsoever.

64
00:03:35,535 --> 00:03:37,150
But if I move it above,

65
00:03:37,150 --> 00:03:42,705
we get this error right here for the field saying that commodity wasn't found.

66
00:03:42,705 --> 00:03:48,405
This Filter Row step has a reference that Power Query can't use.

67
00:03:48,405 --> 00:03:50,345
What we can do instead,

68
00:03:50,345 --> 00:03:53,710
is we can either move it below Promoted Headers,

69
00:03:53,710 --> 00:03:59,770
that'll work fine, or I can leave it there if I really want it there.

70
00:03:59,770 --> 00:04:06,680
I can recognize that column 3 has the first row of commodity as its value,

71
00:04:06,890 --> 00:04:13,370
and I can see that column 3 has commodity as the first value listed,

72
00:04:13,370 --> 00:04:17,535
and I can rename this column 3.

73
00:04:17,535 --> 00:04:23,675
That'll work too. Now, I have a much shorter list.

74
00:04:23,675 --> 00:04:27,505
If we go back to the Advanced Editor,

75
00:04:27,505 --> 00:04:33,670
we can see that the step that we did to constrain the data set just to apples,

76
00:04:33,670 --> 00:04:39,399
is here in the same order that we placed in the Query settings.

77
00:04:39,399 --> 00:04:42,730
But, let's say that I changed my mind.

78
00:04:42,730 --> 00:04:45,820
I don't want to filter this data set to just apples before,

79
00:04:45,820 --> 00:04:47,350
and I'm in a rush,

80
00:04:47,350 --> 00:04:49,840
so I'm just going to delete it, and try to move on.

81
00:04:49,840 --> 00:04:51,505
What do you think will happen?

82
00:04:51,505 --> 00:04:56,070
Well, you're going to end up with an error,

83
00:04:56,070 --> 00:04:57,365
and it's going to ask you,

84
00:04:57,365 --> 00:04:59,495
did you miss a module reference?

85
00:04:59,495 --> 00:05:04,960
This what we've done, is we've just ripped apart a couple of pieces in our knitting,

86
00:05:04,960 --> 00:05:07,820
and there's no corresponding stitch to go.

87
00:05:07,820 --> 00:05:09,830
But we can fix this pretty easily.

88
00:05:09,830 --> 00:05:15,215
Remember, how I said MCO was like knitting and you need to reference prior steps?

89
00:05:15,215 --> 00:05:17,120
We're going to make that fix,

90
00:05:17,120 --> 00:05:19,250
and we're going to fill that hole.

91
00:05:19,250 --> 00:05:23,150
From the second row, references,

92
00:05:23,150 --> 00:05:29,000
produce sheet, Remove Top headers. Here's our problem.

93
00:05:29,000 --> 00:05:34,055
Removed top rows should be here instead of Filtered Rows.

94
00:05:34,055 --> 00:05:38,030
This is trying to connect to a query step that no longer exists.

95
00:05:38,030 --> 00:05:40,645
If I click that right there,

96
00:05:40,645 --> 00:05:45,950
Done, our data pops back.

97
00:05:45,950 --> 00:05:50,190
Easypeasy fund bu. Ready to give it a try?

